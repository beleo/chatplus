{"version":3,"sources":["meteor://ðŸ’»app/packages/rocketchat:push-notifications/server/methods/saveNotificationSettings.js","meteor://ðŸ’»app/packages/rocketchat:push-notifications/server/models/Subscriptions.js"],"names":["Meteor","methods","saveNotificationSettings","rid","field","value","userId","Error","method","check","String","indexOf","subscription","RocketChat","models","Subscriptions","findOneByRoomIdAndUserId","updateAudioNotificationsById","_id","updateDesktopNotificationsById","updateMobilePushNotificationsById","updateEmailNotificationsById","updateUnreadAlertById","updateDisableNotificationsById","updateHideUnreadStatusById","saveAudioNotificationValue","updateAudioNotificationValueById","saveDesktopNotificationDuration","updateDesktopNotificationDurationById","audioNotifications","query","update","$unset","$set","audioNotificationValue","desktopNotifications","desktopNotificationDuration","mobilePushNotifications","emailNotifications","unreadAlert","disableNotifications","hideUnreadStatus","findAlwaysNotifyAudioUsersByRoomId","roomId","find","findAlwaysNotifyDesktopUsersByRoomId","findDontNotifyDesktopUsersByRoomId","findAlwaysNotifyMobileUsersByRoomId","findDontNotifyMobileUsersByRoomId","findNotificationPreferencesByRoom","explicit","$exists","$or","fields","findWithSendEmailByRoomId","u"],"mappings":"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","file":"/packages/rocketchat_push-notifications.js","sourcesContent":["Meteor.methods({\n\tsaveNotificationSettings(rid, field, value) {\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'saveNotificationSettings' });\n\t\t}\n\n\t\tcheck(rid, String);\n\t\tcheck(field, String);\n\t\tcheck(value, String);\n\n\t\tif (['audioNotifications', 'desktopNotifications', 'mobilePushNotifications', 'emailNotifications', 'unreadAlert', 'disableNotifications', 'hideUnreadStatus'].indexOf(field) === -1) {\n\t\t\tthrow new Meteor.Error('error-invalid-settings', 'Invalid settings field', { method: 'saveNotificationSettings' });\n\t\t}\n\n\t\tif (field !== 'hideUnreadStatus' && field !== 'disableNotifications' && ['all', 'mentions', 'nothing', 'default'].indexOf(value) === -1) {\n\t\t\tthrow new Meteor.Error('error-invalid-settings', 'Invalid settings value', { method: 'saveNotificationSettings' });\n\t\t}\n\n\t\tconst subscription = RocketChat.models.Subscriptions.findOneByRoomIdAndUserId(rid, Meteor.userId());\n\t\tif (!subscription) {\n\t\t\tthrow new Meteor.Error('error-invalid-subscription', 'Invalid subscription', { method: 'saveNotificationSettings' });\n\t\t}\n\n\t\tswitch (field) {\n\t\t\tcase 'audioNotifications':\n\t\t\t\tRocketChat.models.Subscriptions.updateAudioNotificationsById(subscription._id, value);\n\t\t\t\tbreak;\n\t\t\tcase 'desktopNotifications':\n\t\t\t\tRocketChat.models.Subscriptions.updateDesktopNotificationsById(subscription._id, value);\n\t\t\t\tbreak;\n\t\t\tcase 'mobilePushNotifications':\n\t\t\t\tRocketChat.models.Subscriptions.updateMobilePushNotificationsById(subscription._id, value);\n\t\t\t\tbreak;\n\t\t\tcase 'emailNotifications':\n\t\t\t\tRocketChat.models.Subscriptions.updateEmailNotificationsById(subscription._id, value);\n\t\t\t\tbreak;\n\t\t\tcase 'unreadAlert':\n\t\t\t\tRocketChat.models.Subscriptions.updateUnreadAlertById(subscription._id, value);\n\t\t\t\tbreak;\n\t\t\tcase 'disableNotifications':\n\t\t\t\tRocketChat.models.Subscriptions.updateDisableNotificationsById(subscription._id, value === '1' ? true : false);\n\t\t\t\tbreak;\n\t\t\tcase 'hideUnreadStatus':\n\t\t\t\tRocketChat.models.Subscriptions.updateHideUnreadStatusById(subscription._id, value === '1' ? true : false);\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn true;\n\t},\n\n\tsaveAudioNotificationValue(rid, value) {\n\t\tconst subscription = RocketChat.models.Subscriptions.findOneByRoomIdAndUserId(rid, Meteor.userId());\n\t\tif (!subscription) {\n\t\t\tthrow new Meteor.Error('error-invalid-subscription', 'Invalid subscription', { method: 'saveAudioNotificationValue' });\n\t\t}\n\t\tRocketChat.models.Subscriptions.updateAudioNotificationValueById(subscription._id, value);\n\t\treturn true;\n\t},\n\n\tsaveDesktopNotificationDuration(rid, value) {\n\t\tconst subscription = RocketChat.models.Subscriptions.findOneByRoomIdAndUserId(rid, Meteor.userId());\n\t\tif (!subscription) {\n\t\t\tthrow new Meteor.Error('error-invalid-subscription', 'Invalid subscription', { method: 'saveDesktopNotificationDuration' });\n\t\t}\n\t\tRocketChat.models.Subscriptions.updateDesktopNotificationDurationById(subscription._id, value);\n\t\treturn true;\n\t}\n});\n","RocketChat.models.Subscriptions.updateAudioNotificationsById = function(_id, audioNotifications) {\n\tconst query = {\n\t\t_id\n\t};\n\n\tconst update = {};\n\n\tif (audioNotifications === 'default') {\n\t\tupdate.$unset = { audioNotifications: 1 };\n\t} else {\n\t\tupdate.$set = { audioNotifications };\n\t}\n\n\treturn this.update(query, update);\n};\n\nRocketChat.models.Subscriptions.updateAudioNotificationValueById = function(_id, audioNotificationValue) {\n\tconst query = {\n\t\t_id\n\t};\n\n\tconst update = {\n\t\t$set: {\n\t\t\taudioNotificationValue\n\t\t}\n\t};\n\n\treturn this.update(query, update);\n};\n\nRocketChat.models.Subscriptions.updateDesktopNotificationsById = function(_id, desktopNotifications) {\n\tconst query = {\n\t\t_id\n\t};\n\n\tconst update = {};\n\n\tif (desktopNotifications === 'default') {\n\t\tupdate.$unset = { desktopNotifications: 1 };\n\t} else {\n\t\tupdate.$set = { desktopNotifications };\n\t}\n\n\treturn this.update(query, update);\n};\n\nRocketChat.models.Subscriptions.updateDesktopNotificationDurationById = function(_id, value) {\n\tconst query = {\n\t\t_id\n\t};\n\n\tconst update = {\n\t\t$set: {\n\t\t\tdesktopNotificationDuration: value - 0\n\t\t}\n\t};\n\n\treturn this.update(query, update);\n};\n\nRocketChat.models.Subscriptions.updateMobilePushNotificationsById = function(_id, mobilePushNotifications) {\n\tconst query = {\n\t\t_id\n\t};\n\n\tconst update = {};\n\n\tif (mobilePushNotifications === 'default') {\n\t\tupdate.$unset = { mobilePushNotifications: 1 };\n\t} else {\n\t\tupdate.$set = { mobilePushNotifications };\n\t}\n\n\treturn this.update(query, update);\n};\n\nRocketChat.models.Subscriptions.updateEmailNotificationsById = function(_id, emailNotifications) {\n\tconst query = {\n\t\t_id\n\t};\n\n\tconst update = {\n\t\t$set: {\n\t\t\temailNotifications\n\t\t}\n\t};\n\n\treturn this.update(query, update);\n};\n\nRocketChat.models.Subscriptions.updateUnreadAlertById = function(_id, unreadAlert) {\n\tconst query = {\n\t\t_id\n\t};\n\n\tconst update = {\n\t\t$set: {\n\t\t\tunreadAlert\n\t\t}\n\t};\n\n\treturn this.update(query, update);\n};\n\nRocketChat.models.Subscriptions.updateDisableNotificationsById = function(_id, disableNotifications) {\n\tconst query = {\n\t\t_id\n\t};\n\n\tconst update = {\n\t\t$set: {\n\t\t\tdisableNotifications\n\t\t}\n\t};\n\n\treturn this.update(query, update);\n};\n\nRocketChat.models.Subscriptions.updateHideUnreadStatusById = function(_id, hideUnreadStatus) {\n\tconst query = {\n\t\t_id\n\t};\n\n\tconst update = {\n\t\t$set: {\n\t\t\thideUnreadStatus\n\t\t}\n\t};\n\n\treturn this.update(query, update);\n};\n\nRocketChat.models.Subscriptions.findAlwaysNotifyAudioUsersByRoomId = function(roomId) {\n\tconst query = {\n\t\trid: roomId,\n\t\taudioNotifications: 'all'\n\t};\n\n\treturn this.find(query);\n};\n\nRocketChat.models.Subscriptions.findAlwaysNotifyDesktopUsersByRoomId = function(roomId) {\n\tconst query = {\n\t\trid: roomId,\n\t\tdesktopNotifications: 'all'\n\t};\n\n\treturn this.find(query);\n};\n\nRocketChat.models.Subscriptions.findDontNotifyDesktopUsersByRoomId = function(roomId) {\n\tconst query = {\n\t\trid: roomId,\n\t\tdesktopNotifications: 'nothing'\n\t};\n\n\treturn this.find(query);\n};\n\nRocketChat.models.Subscriptions.findAlwaysNotifyMobileUsersByRoomId = function(roomId) {\n\tconst query = {\n\t\trid: roomId,\n\t\tmobilePushNotifications: 'all'\n\t};\n\n\treturn this.find(query);\n};\n\nRocketChat.models.Subscriptions.findDontNotifyMobileUsersByRoomId = function(roomId) {\n\tconst query = {\n\t\trid: roomId,\n\t\tmobilePushNotifications: 'nothing'\n\t};\n\n\treturn this.find(query);\n};\n\nRocketChat.models.Subscriptions.findNotificationPreferencesByRoom = function(roomId, explicit) {\n\tconst query = {\n\t\trid: roomId,\n\t\t'u._id': {$exists: true}\n\t};\n\n\tif (explicit) {\n\t\tquery.$or = [\n\t\t\t{audioNotifications: {$exists: true}},\n\t\t\t{audioNotificationValue: {$exists: true}},\n\t\t\t{desktopNotifications: {$exists: true}},\n\t\t\t{desktopNotificationDuration: {$exists: true}},\n\t\t\t{mobilePushNotifications: {$exists: true}},\n\t\t\t{disableNotifications: {$exists: true}}\n\t\t];\n\t}\n\n\treturn this.find(query, { fields: { 'u._id': 1, audioNotifications: 1, audioNotificationValue: 1, desktopNotificationDuration: 1, desktopNotifications: 1, mobilePushNotifications: 1, disableNotifications: 1 } });\n};\n\nRocketChat.models.Subscriptions.findWithSendEmailByRoomId = function(roomId) {\n\tconst query = {\n\t\trid: roomId,\n\t\temailNotifications: {\n\t\t\t$exists: true\n\t\t}\n\t};\n\n\treturn this.find(query, { fields: { emailNotifications: 1, u: 1 } });\n};\n"]}